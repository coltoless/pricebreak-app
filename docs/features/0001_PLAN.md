# Feature Plan: Add Firebase Authentication to PriceBreak

## Description
Integrate Firebase Authentication into the existing PriceBreak Rails application to provide a modern, secure, and user-friendly authentication experience. This will replace or supplement the current Devise authentication system with Firebase's Google Sign-In, email/password, and other social authentication methods.

## Files to Modify

### Authentication Configuration
- `Gemfile` - Add firebase_admin gem
- `config/initializers/firebase.rb` - Firebase configuration
- `config/credentials.yml.enc` - Store Firebase service account keys
- `config/routes.rb` - Add Firebase auth routes

### User Model & Database
- `app/models/user.rb` - Add Firebase UID field and authentication methods
- `db/migrate/` - Create migration for Firebase UID
- `app/controllers/application_controller.rb` - Add Firebase auth helpers
- `app/controllers/concerns/firebase_authenticatable.rb` - Firebase auth concern

### Frontend Authentication
- `app/javascript/application.js` - Add Firebase SDK
- `app/javascript/controllers/firebase_auth_controller.js` - Firebase auth controller
- `app/views/layouts/application.html.erb` - Add Firebase scripts
- `app/views/devise/sessions/new.html.erb` - Update login form
- `app/views/devise/registrations/new.html.erb` - Update registration form

### API Endpoints
- `app/controllers/api/auth_controller.rb` - Firebase token verification
- `app/controllers/api/users_controller.rb` - User profile management

## Implementation Phases

### Phase 1: Backend Setup
1. Install Firebase Admin SDK gem
2. Configure Firebase credentials
3. Create Firebase initializer
4. Add Firebase UID to User model
5. Create database migration

### Phase 2: Authentication Logic
1. Create Firebase authentication concern
2. Update ApplicationController with Firebase helpers
3. Implement token verification
4. Add user creation/update logic

### Phase 3: Frontend Integration
1. Add Firebase JavaScript SDK
2. Create Firebase auth controller
3. Update authentication views
4. Implement sign-in/sign-out flow

### Phase 4: Testing & Migration
1. Test Firebase authentication flow
2. Migrate existing users (if needed)
3. Update tests
4. Deploy and monitor

## Technical Requirements

### Firebase Configuration
- Firebase project setup
- Service account key generation
- Web app configuration
- Authentication methods enabled (Google, Email/Password)

### Security Considerations
- Secure storage of Firebase credentials
- Token validation and expiration handling
- CSRF protection for Firebase auth
- Rate limiting for auth endpoints

### User Experience
- Seamless sign-in flow
- Account linking for existing users
- Profile management
- Sign-out functionality

## Dependencies
- Firebase project and credentials
- firebase_admin gem
- Firebase JavaScript SDK
- Existing Devise setup (for gradual migration)

## Estimated Time
- Backend setup: 4-6 hours
- Authentication logic: 6-8 hours  
- Frontend integration: 4-6 hours
- Testing & migration: 2-4 hours
- **Total: 16-24 hours**

